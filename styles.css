/* IsiVolt Pro · Legionella — styles.css v2.1 */
:root{
  --bg1:#0b132b;
  --a:#00d4ff;
  --b:#2ec4b6;
  --text:#eef2ff;
  --muted:rgba(238,242,255,.72);
  --stroke:rgba(255,255,255,.16);
  --shadow:0 18px 60px rgba(0,0,0,.35);
  --r:22px;
  --safe-bottom:env(safe-area-inset-bottom,0px);
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{height:100%;scroll-behavior:smooth}
body{
  margin:0;
  font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
  color:var(--text);
  background:radial-gradient(1200px 800px at 20% 10%,#12224a 0%,var(--bg1) 40%,#040814 100%);
  overflow-x:hidden;
  -webkit-font-smoothing:antialiased;
}

/* ── Ambient FX ── */
.bg-sheen{
  position:fixed;inset:-40%;
  background:
    radial-gradient(circle at 20% 20%,rgba(0,212,255,.10),transparent 40%),
    radial-gradient(circle at 80% 60%,rgba(46,196,182,.08),transparent 45%),
    linear-gradient(120deg,transparent 30%,rgba(255,255,255,.06) 45%,transparent 60%);
  mix-blend-mode:screen;filter:blur(18px);
  animation:sheen 14s ease-in-out infinite;z-index:-3;pointer-events:none;
}
@keyframes sheen{0%,100%{transform:translate3d(0,0,0) rotate(0deg);opacity:.55}50%{transform:translate3d(40px,-30px,0) rotate(8deg);opacity:.75}}
.bg-blob{
  position:fixed;width:520px;height:520px;border-radius:999px;
  filter:blur(50px);opacity:.35;z-index:-2;animation:float 10s ease-in-out infinite;
}
.blob-a{left:-160px;top:-120px;background:radial-gradient(circle at 30% 30%,var(--a),transparent 60%)}
.blob-b{right:-200px;bottom:-180px;background:radial-gradient(circle at 30% 30%,var(--b),transparent 60%);animation-duration:12s}
@keyframes float{0%,100%{transform:translate3d(0,0,0) scale(1)}50%{transform:translate3d(20px,-18px,0) scale(1.03)}}
@keyframes floatIcon{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-6px)}75%{transform:translateX(6px)}}

/* ── Layout ── */
.container{max-width:1100px;margin:0 auto;padding:14px 12px calc(110px + var(--safe-bottom))}
.topbar{
  position:sticky;top:0;z-index:10;
  display:flex;justify-content:space-between;align-items:center;
  margin:8px 10px;padding:10px 14px;
}
.brand{display:flex;gap:12px;align-items:center}
.logo{
  width:40px;height:40px;border-radius:14px;flex-shrink:0;
  display:grid;place-items:center;
  background:linear-gradient(135deg,rgba(0,212,255,.28),rgba(46,196,182,.18));
  border:1px solid var(--stroke);box-shadow:var(--shadow);font-size:18px;
}
.title{font-weight:800;letter-spacing:.2px;font-size:15px}
.subtitle{font-size:11px;color:var(--muted);margin-top:1px}
.hdr-btns{display:flex;gap:6px;align-items:center}

/* ── Glass ── */
.glass{
  background:linear-gradient(180deg,rgba(255,255,255,.10),rgba(255,255,255,.06));
  border:1px solid var(--stroke);border-radius:var(--r);
  box-shadow:var(--shadow);backdrop-filter:blur(14px);
}
.glass-lite{
  background:linear-gradient(180deg,rgba(255,255,255,.07),rgba(255,255,255,.03));
  border:1px solid rgba(255,255,255,.12);border-radius:18px;
  backdrop-filter:blur(12px);padding:14px;
}

/* ── Cards ── */
.card{padding:16px}
.panel{padding:14px}
.grid{display:grid;gap:12px;grid-template-columns:1fr}
.grid2{display:grid;gap:12px;grid-template-columns:1fr}
@media(min-width:760px){.grid{grid-template-columns:1fr 1fr}.grid2{grid-template-columns:1.1fr .9fr}}

/* ── Typography ── */
h1,h2,h3{margin:0 0 10px}
h1{font-size:22px}h2{font-size:18px}h3{font-size:15px;color:rgba(238,242,255,.92)}
.muted{color:var(--muted)}.tiny{font-size:12px;line-height:1.4}.empty{padding:12px}
.divider{height:1px;background:rgba(255,255,255,.14);margin:12px 0}
.divider.thin{background:rgba(255,255,255,.10);margin:10px 0}

/* ── Flex ── */
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.row.space-between{justify-content:space-between}
.row.center{justify-content:center}
.col{display:flex;flex-direction:column}

/* ── Inputs ── */
.input,select.input{
  width:100%;padding:13px 12px;border-radius:16px;
  border:1px solid rgba(255,255,255,.14);background:rgba(0,0,0,.18);
  color:var(--text);outline:none;font-size:16px;
}
.textarea{resize:vertical}
.input:focus{border-color:rgba(0,212,255,.45);box-shadow:0 0 0 4px rgba(0,212,255,.10)}
.label{display:block;font-size:12px;color:var(--muted);margin:10px 0 5px}

/* ── Buttons ── */
.btn{
  padding:12px 14px;border-radius:16px;border:1px solid rgba(255,255,255,.16);
  background:rgba(255,255,255,.08);color:var(--text);cursor:pointer;
  font-size:14px;font-weight:500;
  transition:transform .08s ease,background .15s ease,border-color .15s ease;
  white-space:nowrap;min-height:48px;display:inline-flex;align-items:center;justify-content:center;
}
.btn:active{transform:scale(.97)}
.btn:hover{background:rgba(255,255,255,.12);border-color:rgba(255,255,255,.24)}
.btn-primary{background:linear-gradient(135deg,rgba(0,212,255,.30),rgba(46,196,182,.22));border-color:rgba(0,212,255,.30)}
.btn-primary:hover{background:linear-gradient(135deg,rgba(0,212,255,.42),rgba(46,196,182,.32))}
.btn-danger{background:rgba(255,70,90,.18);border-color:rgba(255,70,90,.30)}
.btn-ghost{background:rgba(0,0,0,.14)}
.btn-icon{padding:10px;border-radius:14px;min-height:44px;min-width:44px;font-size:18px}
.btn-sm{padding:8px 12px;min-height:40px;font-size:13px;border-radius:14px}
.btn-lg{padding:16px;font-size:16px;width:100%}
.actions{display:grid;gap:8px;grid-template-columns:1fr}
@media(min-width:440px){.actions{grid-template-columns:1fr 1fr}}

/* ── KPI ── */
.kpi{display:flex;justify-content:space-between;align-items:center;gap:10px}
.kpi-2{margin-top:10px}
.kpi-value{font-size:22px;font-weight:800;letter-spacing:.3px}
.pill{font-size:11px;padding:5px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.16);background:rgba(0,0,0,.14)}

/* ── List / Item ── */
.list{display:flex;flex-direction:column;gap:8px}
.item{
  display:flex;justify-content:space-between;align-items:center;gap:8px;
  padding:12px;border-radius:18px;border:1px solid rgba(255,255,255,.12);
  background:rgba(255,255,255,.05);flex-wrap:wrap;
}
.item .left{display:flex;flex-direction:column;gap:2px;min-width:0;flex:1}
.item .code{font-weight:900;letter-spacing:.7px;font-size:16px}
.item .meta{font-size:12px;color:var(--muted);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:55vw}
.item-right{display:flex;gap:6px;align-items:center;flex-wrap:wrap;justify-content:flex-end}

/* ── Timer indicator in OT list ── */
.timer-indicator{
  display:inline-flex;align-items:center;gap:5px;
  padding:4px 8px;border-radius:999px;font-size:11px;font-weight:700;
  background:linear-gradient(135deg,rgba(0,212,255,.25),rgba(46,196,182,.18));
  border:1px solid rgba(0,212,255,.30);animation:pulse-border 1.5s ease-in-out infinite;
}
@keyframes pulse-border{0%,100%{border-color:rgba(0,212,255,.30)}50%{border-color:rgba(0,212,255,.65)}}

/* ── Badges ── */
.badge{padding:5px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.18);font-size:12px;white-space:nowrap}
.badge.ok{background:rgba(46,196,182,.16);border-color:rgba(46,196,182,.28)}
.badge.todo{background:rgba(0,212,255,.10);border-color:rgba(0,212,255,.20)}
.badge.issue{background:rgba(255,70,90,.14);border-color:rgba(255,70,90,.28)}
.badge.na{background:rgba(255,255,255,.06);border-color:rgba(255,255,255,.22)}

/* ── Big code / dose ── */
.bigcode{font-size:28px;font-weight:900;letter-spacing:1.6px}
.dose{font-size:36px;font-weight:900;letter-spacing:.5px;margin-top:4px}
.calc-result{padding:10px 12px;border-radius:18px;background:rgba(0,0,0,.14);border:1px solid rgba(255,255,255,.10)}
.checklist{display:flex;flex-direction:column;gap:12px}
.checklist label{display:flex;gap:12px;align-items:center;color:rgba(238,242,255,.9);cursor:pointer}
.checklist input{transform:scale(1.3);cursor:pointer}
.hidden{display:none !important}

/* ── Scan ── */
.scanbox{
  position:relative;width:100%;aspect-ratio:4/3;border-radius:18px;overflow:hidden;
  border:1px solid rgba(255,255,255,.14);background:rgba(0,0,0,.22);margin:12px 0;
}
#qrVideo{width:100%;height:100%;object-fit:cover}
.scan-overlay{
  position:absolute;inset:0;
  background:linear-gradient(transparent 0%,rgba(0,0,0,.12) 20%,transparent 40%),
    radial-gradient(circle at 50% 50%,transparent 42%,rgba(0,0,0,.30) 70%);
  pointer-events:none;
}

/* ════════════════════════════════════════════════
   WATER TANK — Chorro de agua desde arriba
   ════════════════════════════════════════════════ */
.timer-tank{
  position:relative;
  width:min(300px,80vw);height:min(300px,80vw);
  margin:16px auto 12px;border-radius:24px;overflow:hidden;
  border:2px solid rgba(0,212,255,.22);box-shadow:var(--shadow),0 0 40px rgba(0,212,255,.10);
  background:rgba(4,8,20,.55);
}

/* Chorro de agua */
.water-stream{
  position:absolute;left:50%;top:0;transform:translateX(-50%);
  width:14px;z-index:5;pointer-events:none;
  display:flex;flex-direction:column;align-items:center;
}
.stream-tube{
  width:10px;height:16px;
  background:linear-gradient(180deg,rgba(180,230,255,.6),rgba(0,212,255,.4));
  border-radius:4px 4px 0 0;margin-bottom:0;
  border:1px solid rgba(0,212,255,.5);border-bottom:none;
}
.stream-body{
  width:8px;
  background:linear-gradient(180deg,rgba(0,212,255,.7),rgba(46,196,182,.5));
  border-radius:0 0 3px 3px;
  animation:stream-grow .2s ease-out;
  /* altura dinámica: se pone vía JS como style.height */
  min-height:4px;
}
.stream-drop{
  position:absolute;top:0;width:5px;height:9px;
  background:rgba(0,212,255,.65);border-radius:50% 50% 60% 60%;
  animation:drop-fall 0.55s linear infinite;
  animation-delay:var(--dl,0s);
  transform:translateX(var(--dx,0));
  opacity:.8;
  left:50%;margin-left:-2px;
}
@keyframes drop-fall{
  0%{transform:translateX(var(--dx,0)) translateY(0);opacity:.8}
  80%{opacity:.6}
  100%{transform:translateX(var(--dx,0)) translateY(180px);opacity:0}
}
@keyframes stream-grow{from{min-height:0}to{min-height:4px}}

/* Salpicaduras en la superficie del agua */
.splash-zone{
  position:absolute;left:50%;transform:translateX(-50%);
  z-index:6;width:60px;pointer-events:none;
  /* bottom se pone dinámicamente via JS según el nivel */
}
.splash{
  position:absolute;bottom:0;left:50%;
  width:6px;height:6px;border-radius:50%;
  background:rgba(0,212,255,.7);
  animation:splash-anim 0.6s ease-out infinite;
  animation-delay:var(--sd,0s);
  transform:translateX(var(--sx,0));
  opacity:0;
}
@keyframes splash-anim{
  0%{transform:translateX(var(--sx,0)) scale(1) translateY(0);opacity:.9}
  60%{transform:translateX(var(--sx,0)) scale(1.8) translateY(-8px);opacity:.4}
  100%{transform:translateX(var(--sx,0)) scale(2.5) translateY(-14px);opacity:0}
}

/* Agua que sube desde el fondo */
.water{
  position:absolute;left:0;right:0;bottom:0;height:0%;
  background:linear-gradient(180deg,rgba(0,212,255,.45) 0%,rgba(46,196,182,.38) 40%,rgba(0,80,140,.6) 100%);
  transition:height .3s linear;z-index:2;
}
.wave-surface{
  position:absolute;left:-10%;right:-10%;top:-6px;height:14px;
  background:rgba(0,212,255,.25);border-radius:50%;
  animation:wave-surf 1.8s ease-in-out infinite;
}
@keyframes wave-surf{
  0%,100%{transform:translateX(-4%) scaleY(1)}
  50%{transform:translateX(4%) scaleY(1.3)}
}
/* Brillo de agua */
.water::after{
  content:"";position:absolute;left:10%;top:10%;width:30%;height:60%;
  background:linear-gradient(180deg,rgba(255,255,255,.18),transparent);
  border-radius:50%;filter:blur(4px);
}
.tank-glass{
  position:absolute;inset:0;
  background:linear-gradient(120deg,rgba(255,255,255,.08),transparent 38%,rgba(255,255,255,.04));
  pointer-events:none;z-index:8;
}
.timer-overlay{
  position:absolute;inset:0;display:grid;place-items:center;padding:16px;z-index:9;
}
.timer-left{
  font-size:52px;font-weight:900;letter-spacing:1px;
  text-shadow:0 2px 20px rgba(0,0,0,.7),0 0 30px rgba(0,212,255,.3);
}

/* ── Seal ── */
.seal{
  display:inline-block;padding:12px 16px;border-radius:999px;
  border:1px solid rgba(46,196,182,.35);background:rgba(46,196,182,.16);
  font-weight:900;letter-spacing:.6px;animation:pop .22s ease-out;
}
.seal-warn{border-color:rgba(255,70,90,.35);background:rgba(255,70,90,.14)}
@keyframes pop{from{transform:scale(.92);opacity:0}to{transform:scale(1);opacity:1}}

/* ── Modal ── */
.modal{
  position:fixed;inset:0;background:rgba(0,0,0,.52);
  display:grid;place-items:center;padding:16px;z-index:20;
}
.modal-card{width:min(980px,96vw);padding:16px}

/* ════════════════════════════════════════════════
   AUDIO VISUALIZER — Guía Legionella
   ════════════════════════════════════════════════ */
.audio-visualizer{
  position:relative;
  height:160px;border-radius:20px;overflow:hidden;
  background:linear-gradient(135deg,rgba(4,8,20,.8),rgba(0,40,60,.6));
  border:1px solid rgba(0,212,255,.20);
  display:flex;align-items:center;justify-content:center;
  margin:4px 0 6px;
}
.av-glow{
  position:absolute;inset:0;
  background:radial-gradient(ellipse at 50% 50%,rgba(0,212,255,.08),transparent 65%);
  pointer-events:none;
}

/* Bacteria animada */
.av-bacteria{
  position:absolute;left:18px;bottom:20px;
  display:flex;align-items:center;
}
.bact-body{
  width:32px;height:22px;border-radius:50%;
  background:radial-gradient(circle at 35% 35%,rgba(46,196,182,.8),rgba(0,180,120,.5));
  border:1px solid rgba(46,196,182,.5);position:relative;
  animation:bact-pulse 3s ease-in-out infinite;
}
.bact-nucleus{
  position:absolute;top:30%;left:25%;width:40%;height:40%;
  border-radius:50%;background:rgba(0,212,255,.4);
  animation:bact-pulse 2s ease-in-out infinite reverse;
}
@keyframes bact-pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.08)}}
.bact-flag{
  position:absolute;bottom:2px;left:50%;
  width:2px;height:var(--fl,24px);
  background:linear-gradient(180deg,rgba(46,196,182,.7),transparent);
  border-radius:999px;transform-origin:top center;
  transform:rotate(var(--fa,0deg));
  animation:flag-wave 1.2s ease-in-out infinite;
  animation-delay:var(--fd,0s);
}
@keyframes flag-wave{
  0%,100%{transform:rotate(var(--fa,0deg)) scaleY(1)}
  50%{transform:rotate(calc(var(--fa,0deg) + 15deg)) scaleY(0.85)}
}

/* Barras del ecualizador */
.av-bars{
  display:flex;gap:5px;align-items:flex-end;height:90px;padding:0 8px;
}
.av-bar{
  width:10px;border-radius:4px 4px 2px 2px;
  background:linear-gradient(180deg,rgba(0,212,255,.9),rgba(46,196,182,.6));
  box-shadow:0 0 6px rgba(0,212,255,.3);
  min-height:6px;
  animation:bar-idle 1.4s ease-in-out infinite;
  animation-delay:calc(var(--bi,0) * 0.09s);
}
@keyframes bar-idle{
  0%,100%{height:12px;opacity:.5}
  50%{height:22px;opacity:.8}
}
.av-bar.speaking{
  animation:bar-speak 0.18s ease-in-out infinite alternate;
  animation-delay:calc(var(--bi,0) * 0.04s);
}
@keyframes bar-speak{
  0%{height:8px}
  100%{height:calc(20px + var(--bi,0) * 4px)}
}
.av-label{
  position:absolute;bottom:8px;right:12px;
  font-size:11px;color:var(--muted);letter-spacing:.5px;
}

/* Tarjetas legionella info */
.legionella-cards{display:grid;grid-template-columns:1fr;gap:8px}
@media(min-width:600px){.legionella-cards{grid-template-columns:1fr 1fr}}
.leg-card{
  display:flex;gap:12px;align-items:flex-start;
  padding:12px;border-radius:16px;
  background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.10);
}
.leg-icon{font-size:22px;flex-shrink:0;margin-top:1px}
.leg-title{font-weight:700;font-size:13px;margin-bottom:3px}
.leg-desc{font-size:12px;color:var(--muted);line-height:1.4}

/* ════════════════════════════════════════════════
   PPM CALCULATOR
   ════════════════════════════════════════════════ */
.ppm-result-card{
  background:rgba(0,0,0,.22);border:1px solid rgba(0,212,255,.20);
  border-radius:18px;padding:16px;text-align:center;
  display:flex;flex-direction:column;align-items:center;justify-content:center;gap:4px;
  min-height:180px;
}
.ppm-lbl{font-size:12px;color:var(--muted);margin-bottom:4px}
.ppm-val{font-size:36px;font-weight:900;letter-spacing:.5px;color:var(--a)}
.ppm-unit{font-size:12px;color:var(--muted)}
.ppm-detail{font-size:11px;margin-top:4px;max-width:180px;text-align:center}
.formula-box{
  margin-top:12px;padding:10px 12px;border-radius:14px;
  background:rgba(0,0,0,.18);border:1px solid rgba(255,255,255,.10);
  font-size:12px;color:var(--muted);line-height:1.6;
}

/* ════════════════════════════════════════════════
   FLOAT TIMERS BAR
   ════════════════════════════════════════════════ */
.float-bar{
  position:fixed;bottom:0;left:0;right:0;z-index:30;
  padding:10px 12px calc(10px + var(--safe-bottom));
  background:linear-gradient(0deg,rgba(11,19,43,.96),rgba(11,19,43,.88));
  border-top:1px solid rgba(255,255,255,.18);backdrop-filter:blur(18px);
  display:flex;gap:8px;overflow-x:auto;align-items:stretch;
  scroll-snap-type:x mandatory;-webkit-overflow-scrolling:touch;
}
.float-bar::-webkit-scrollbar{display:none}
.timer-chip{
  scroll-snap-align:start;flex-shrink:0;
  display:flex;flex-direction:column;gap:3px;
  padding:10px 12px;border-radius:16px;
  background:linear-gradient(135deg,rgba(0,212,255,.18),rgba(46,196,182,.12));
  border:1px solid rgba(0,212,255,.30);
  cursor:pointer;min-width:130px;
  transition:transform .1s ease;
}
.timer-chip:active{transform:scale(.97)}
.timer-chip.paused{background:rgba(255,255,255,.07);border-color:rgba(255,255,255,.20)}
.timer-chip.finished{background:rgba(46,196,182,.18);border-color:rgba(46,196,182,.40)}
.chip-code{font-weight:900;font-size:14px;letter-spacing:.7px}
.chip-hotel{font-size:10px;color:var(--muted);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:108px}
.chip-time{font-size:22px;font-weight:900;letter-spacing:.5px;line-height:1;margin:2px 0}
.chip-status{font-size:10px;color:var(--muted)}
.chip-actions{display:flex;gap:4px;margin-top:4px}
.chip-btn{
  flex:1;padding:5px 4px;border-radius:10px;font-size:12px;
  border:1px solid rgba(255,255,255,.18);background:rgba(0,0,0,.20);
  color:var(--text);cursor:pointer;
}
.chip-btn:active{transform:scale(.95)}
.chip-btn.finish-btn{background:rgba(46,196,182,.20);border-color:rgba(46,196,182,.35)}

/* ── Toast ── */
.toast{
  position:fixed;bottom:calc(80px + 12px + var(--safe-bottom));
  left:50%;transform:translateX(-50%);
  background:rgba(30,40,70,.95);border:1px solid rgba(255,255,255,.20);
  backdrop-filter:blur(12px);border-radius:999px;
  padding:10px 18px;font-size:14px;font-weight:600;color:var(--text);
  z-index:40;white-space:nowrap;max-width:90vw;
  opacity:0;transition:opacity .2s ease;pointer-events:none;
}
.toast.show{opacity:1}

/* ── Accordions ── */
.accordions{display:flex;flex-direction:column;gap:10px}
.accordion{border-radius:18px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.05);overflow:hidden}
.acc-head{display:flex;justify-content:space-between;align-items:center;gap:10px;padding:12px;cursor:pointer;user-select:none}
.acc-title{font-weight:900;letter-spacing:.4px}
.acc-sub{font-size:12px;color:var(--muted)}
.acc-body{padding:12px;display:none;border-top:1px solid rgba(255,255,255,.10)}
.accordion.open .acc-body{display:block;animation:pop .18s ease-out}
.progress{height:10px;border-radius:999px;background:rgba(0,0,0,.18);border:1px solid rgba(255,255,255,.10);overflow:hidden;width:min(200px,38vw)}
.progress>div{height:100%;width:0%;background:linear-gradient(90deg,rgba(0,212,255,.55),rgba(46,196,182,.45));transition:width .25s ease}
.item-actions{display:flex;gap:6px;align-items:center;flex-wrap:wrap;justify-content:flex-end}
.smallbtn{
  padding:8px 10px;border-radius:14px;
  border:1px solid rgba(255,255,255,.16);background:rgba(0,0,0,.12);
  color:var(--text);cursor:pointer;min-height:40px;font-size:14px;
}
.smallbtn:hover{background:rgba(255,255,255,.10)}
.smallbtn.ok{border-color:rgba(46,196,182,.35)}
.smallbtn.issue{border-color:rgba(255,70,90,.35)}
.smallbtn.na{border-color:rgba(255,255,255,.25)}

/* ── Screens ── */
.screen{animation:fadeIn .18s ease}
@keyframes fadeIn{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:none}}

/* ── Mobile tweaks ── */
@media(max-width:600px){
  .card{padding:14px}
  .grid2{grid-template-columns:1fr}
  .bigcode{font-size:24px}
  .kpi-value{font-size:20px}
  .timer-left{font-size:44px}
}
